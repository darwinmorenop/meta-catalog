<div class="filter-section" *ngIf="data.length > 0">
    <mat-form-field appearance="outline" class="global-search">
        <mat-label>BÃºsqueda Global</mat-label>
        <input matInput [(ngModel)]="globalFilter" (keyup)="applyFilters()" placeholder="Buscar en todo...">
    </mat-form-field>

    <div class="column-filters">
        <ng-container *ngFor="let col of config.columns">
            <mat-form-field *ngIf="col.filterable" appearance="outline" class="col-filter">
                <mat-label>Filtrar {{col.header}}</mat-label>
                <mat-select [(ngModel)]="columnFilters[col.key]" (selectionChange)="applyFilters()">
                    <div class="search-select-container">
                        <input matInput (keyup)="filterOptionsList(col.key, $event)"
                            (keydown)="$event.stopPropagation()" placeholder="Buscar..." class="search-select-input">
                    </div>
                    <mat-option value="">Todos</mat-option>
                    <mat-option *ngFor="let val of filteredFilterOptions[col.key]" [value]="val">{{ val }}</mat-option>
                </mat-select>
            </mat-form-field>
        </ng-container>
    </div>
</div>

<div class="table-container mat-elevation-z8" *ngIf="data.length > 0; else noData">
    <table mat-table [dataSource]="dataSource" matSort>

        <ng-container *ngFor="let col of config.columns" [matColumnDef]="col.key">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> {{col.header}} </th>
            <td mat-cell *matCellDef="let element">
                <ng-container [ngSwitch]="col.type">
                    <!-- Badge Type -->
                    <span *ngSwitchCase="'badge'" [class.stock-ok]="element[col.key] === 'in stock'"
                        [class.stock-out]="element[col.key] === 'out of stock'">
                        {{element[col.key]}}
                    </span>

                    <!-- Currency Type (Simple placeholder) -->
                    <span *ngSwitchCase="'currency'">
                        {{ element[col.key] }}
                    </span>

                    <!-- Default Text -->
                    <span *ngSwitchDefault>
                        {{ element[col.key] }}
                    </span>
                </ng-container>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selectRow(row)"
            [class.selected-row]="selectedRow === row">
        </tr>
    </table>

    <mat-paginator [pageSizeOptions]="config.pageSizeOptions" showFirstLastButtons></mat-paginator>
</div>

<ng-template #noData>
    <div class="empty-state">
        <p>No hay datos para mostrar.</p>
    </div>
</ng-template>